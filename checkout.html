<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout | ThreadAura</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; margin: 0; background: #f4f4f4; }
        header, footer { background: #4CAF50; color: #fff; padding: 15px 0; text-align: center; }
        header h1, footer p { margin: 0; }
        nav ul { list-style: none; padding: 0; display: flex; justify-content: center; gap: 20px; }
        nav a { color: #fff; text-decoration: none; }
        .container { max-width: 1000px; margin: 20px auto; padding: 20px; background: #fff; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .checkout-container { display: flex; flex-wrap: wrap; gap: 20px; }
        .checkout-form, .order-summary { flex: 1; min-width: 300px; }
        label { display: block; margin-bottom: 10px; }
        input, textarea, select, button { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
        button { background: #4CAF50; color: #fff; border: none; cursor: pointer; transition: 0.3s; }
        button:hover { background: #45a049; }
        .momo-fields { margin-top: 10px; }
        .total { font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>

<header>
    <h1>ThreadAura</h1>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="products.html">Products</a></li>
            <li><a href="cart.html">Cart (<span id="cart-count">0</span>)</a></li>
        </ul>
    </nav>
</header>

<div class="container checkout-container">

    <!-- Checkout Form -->
    <form id="checkout-form" class="checkout-form" onsubmit="return false;">
        <h2>Checkout</h2>
        <label>Full Name
            <input type="text" name="name" placeholder="John Doe" required>
        </label>
        <label>Email Address
            <input type="email" name="email" placeholder="email@example.com" required>
        </label>
        <label>Delivery Address
            <textarea name="address" placeholder="Enter your delivery address" required></textarea>
        </label>

        <label>Payment Method
            <select name="payment" id="payment-method" required>
                <option value="">Select payment method</option>
                <option value="MTN">MTN Mobile Money</option>
                <option value="Vodafone">Vodafone Cash</option>
                <option value="Cash">Cash on Delivery</option>
                <option value="PayPal">PayPal</option>
            </select>
        </label>

        <div id="momo-fields" class="momo-fields" style="display: none;">
            <label>Mobile Network
                <input type="text" id="momo-network" readonly>
            </label>
            <label>Mobile Number
                <input type="tel" id="momo-number" placeholder="e.g. 0241234567" required>
            </label>
            <label>MoMo Name
                <input type="text" id="momo-name" placeholder="Registered name" required>
            </label>
        </div>

        <button type="button" onclick="makePayment()">Pay Now</button>
    </form>

    <!-- Order Summary -->
    <div class="order-summary">
        <h3>Order Summary</h3>
        <div id="checkout-items">
            <p>Sample Product x 1</p>
        </div>
        <p class="total">Total: GHS <span id="checkout-total">100.00</span></p>
    </div>

</div>

<footer>
    <p>&copy; 2026 ThreadAura. All rights reserved.</p>
</footer>

<!-- Flutterwave SDK -->
<script src="https://checkout.flutterwave.com/v3.js"></script>
<!-- PayPal SDK -->
<script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD"></script>

<script>
    const paymentSelect = document.getElementById("payment-method");
    const momoFields = document.getElementById("momo-fields");

    // Show/hide MoMo fields
    paymentSelect.addEventListener("change", () => {
        if (paymentSelect.value === "MTN" || paymentSelect.value === "Vodafone") {
            momoFields.style.display = "block";
            document.getElementById("momo-network").value = paymentSelect.value;
        } else {
            momoFields.style.display = "none";
        }
    });

    function makePayment() {
        const paymentMethod = paymentSelect.value;
        if (!paymentMethod) return alert("Please select a payment method.");

        const name = document.querySelector('input[name="name"]').value;
        const email = document.querySelector('input[name="email"]').value;
        const phone = document.getElementById("momo-number").value || "";
        const totalAmount = document.getElementById("checkout-total").innerText;

        if ((paymentMethod === "MTN" || paymentMethod === "Vodafone") && !phone) return alert("Please enter your mobile number.");

        // Cash on Delivery
        if (paymentMethod === "Cash") {
            window.location.href = `paymentsuc.html?method=Cash&name=${encodeURIComponent(name)}&amount=${encodeURIComponent(totalAmount)}`;
            return;
        }

        // Mobile Money (Flutterwave)
        if (paymentMethod === "MTN" || paymentMethod === "Vodafone") {
            FlutterwaveCheckout({
                public_key: "FLWPUBK_TEST-xxxxx",
                tx_ref: "TX_" + Date.now(),
                amount: totalAmount,
                currency: "GHS",
                payment_options: "mobilemoneyghana",
                customer: { email, phone_number: phone, name },
                callback: function (data) {
                    if (data.status === "successful") {
                        window.location.href = `paymentsuc.html?method=${paymentMethod}&ref=${data.tx_ref}&name=${encodeURIComponent(name)}&amount=${encodeURIComponent(totalAmount)}`;
                    } else {
                        alert("âŒ Payment failed. Please try again.");
                    }
                }
            });
        }

        // PayPal
        if (paymentMethod === "PayPal") {
            paypal.Buttons({
                createOrder: (data, actions) => {
                    return actions.order.create({ purchase_units: [{ amount: { value: totalAmount } }] });
                },
                onApprove: (data, actions) => {
                    return actions.order.capture().then(() => {
                        window.location.href = `paymentsuc.html?method=PayPal&order=${data.orderID}&name=${encodeURIComponent(name)}&amount=${encodeURIComponent(totalAmount)}`;
                    });
                }
            }).render('body');
        }
    }
</script>

</body>
</html>
